<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vokabeltrainer mit Tachometer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            text-align: center;
        }

        #progress-container {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 80%;
            height: 20px;
            background-color: #e0e0e0;
            border-radius: 20px;
        }

        #progress-bar {
            height: 100%;
            width: 0%;
            background-color: #76c7c0;
        }

        #progress-text {
            margin-top: 10px;
        }

        #word-container {
            margin-top: 50px;
            display: none;
        }

        #tachometer-container {
            margin: 50px auto;
            width: 400px;
            height: 200px;
        }

        #result-buttons {
            display: none;
            justify-content: center;
            margin-top: 20px;
        }

        #retry, #undefined-button {
            background-color: #76c7c0;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 0 10px;
            font-size: 1em;
            cursor: pointer;
            border-radius: 5px;
        }

        #show-answer, #known, #not-known {
            margin: 20px;
            padding: 10px 20px;
            font-size: 1em;
            cursor: pointer;
        }

        #buttons {
            display: none;
        }

        #result-chart {
            display: none;
        }
    </style>
</head>
<body>
    <h1>Vokabeltrainer</h1>

    <div id="progress-container">
        <div id="progress-bar"></div>
    </div>
    <p id="progress-text">0/0</p>

    <div id="word-container">
        <div id="latin-word"></div>
        <div id="german-word" style="display: none;"></div>
    </div>

    <button id="show-answer">Antwort anzeigen</button>
    <div id="buttons">
        <button id="not-known">Nicht gewusst</button>
        <button id="known">Gewusst</button>
    </div>

    <div id="tachometer-container">
        <canvas id="result-chart" width="400" height="200"></canvas>
    </div>
    <div id="result-buttons">
        <button id="retry">Nochmal</button>
        <button id="undefined-button">Ohne Funktion</button>
    </div>

    <script>
        const csvUrl = 'https://raw.githubusercontent.com/nickclass007/Navis-Salutaris/main/Woerter/LW1.csv';
        let words = [];
        let currentWord = {};
        let progress = 0;
        let correctCount = 0;
        let totalWords = 0;

        // Fortschrittsbalken aktualisieren
        function updateProgress() {
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const progressPercentage = Math.floor((progress / totalWords) * 100);
            progressBar.style.width = `${progressPercentage}%`;
            progressText.textContent = `${progress}/${totalWords}`;
        }

        // Wörter laden
        fetch(csvUrl)
            .then(response => response.text())
            .then(data => {
                const rows = data.split('\n');
                rows.forEach((row, index) => {
                    const columns = row.split(',');
                    if (index > 0 && columns.length >= 3) {
                        words.push({ latin: columns[0], german: columns[2] });
                    }
                });
                totalWords = words.length;
                updateProgress();
                showNextWord();
            });

        // Nächstes Wort anzeigen
        function showNextWord() {
            if (words.length === 0) {
                showResults();
                return;
            }
            currentWord = words.pop();
            document.getElementById('latin-word').textContent = currentWord.latin;
            document.getElementById('german-word').style.display = 'none';
            document.getElementById('buttons').style.display = 'none';
            document.getElementById('show-answer').style.display = 'inline-block';
        }

        document.getElementById('show-answer').addEventListener('click', () => {
            document.getElementById('german-word').style.display = 'inline-block';
            document.getElementById('buttons').style.display = 'block';
            document.getElementById('show-answer').style.display = 'none';
        });

        document.getElementById('not-known').addEventListener('click', () => {
            progress++;
            updateProgress();
            showNextWord();
        });

        document.getElementById('known').addEventListener('click', () => {
            correctCount++;
            progress++;
            updateProgress();
            showNextWord();
        });

        function drawTachometer(percentage) {
            const canvas = document.getElementById("result-chart");
            const ctx = canvas.getContext("2d");
            const centerX = canvas.width / 2;
            const centerY = canvas.height;
            const radius = canvas.width / 2;
            const startAngle = Math.PI;
            const endAngle = startAngle + (Math.PI * percentage) / 100;

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Rot
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, startAngle, startAngle + Math.PI / 2);
            ctx.strokeStyle = "#f00";
            ctx.lineWidth = 20;
            ctx.stroke();

            // Grün
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, startAngle + Math.PI / 2, startAngle + Math.PI);
            ctx.strokeStyle = "#0f0";
            ctx.stroke();

            // Fortschritt (Gelb)
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, startAngle, endAngle);
            ctx.strokeStyle = "#FFD700";
            ctx.stroke();

            // Prozentanzeige
            ctx.font = "20px Arial";
            ctx.textAlign = "center";
            ctx.fillStyle = "#000";
            ctx.fillText(`${percentage}%`, centerX, centerY - 30);
        }

        function showResults() {
            const percentage = Math.floor((correctCount / totalWords) * 100);
            document.getElementById('word-container').style.display = 'none';
            document.getElementById('progress-container').style.display = 'none';
            document.getElementById('progress-text').style.display = 'none';
            document.getElementById('result-chart').style.display = 'block';
            document.getElementById('result-buttons').style.display = 'flex';
            drawTachometer(percentage);
        }

        document.getElementById('retry').addEventListener('click', () => {
            location.reload();
        });

        document.getElementById('undefined-button').addEventListener('click', () => {
            alert('Dieser Button hat keine Funktion.');
        });
    </script>
</body>
</html>
