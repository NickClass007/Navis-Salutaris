<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vokabeltrainer</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            min-height: 100vh;
            background-color: #f7f7f7;
        }
        .hidden { display: none; }
        button {
            padding: 10px 20px;
            font-size: 1.2em;
            cursor: pointer;
            margin-top: 20px;
            background-color: #76c7c0;
            border: none;
            border-radius: 5px;
            color: white;
        }
    </style>
</head>
<body>
    <div id="menu">
        <h2>Wählen Sie eine CSV-Datei</h2>
        <select id="csv-select">
            <option value="LW1">LW1</option>
            <option value="Caesars_Bellum_Gallicum_III">Caesars Bellum Gallicum III</option>
            <option value="LW2">LW2</option>
        </select>
        <button id="load-file">Vokabeln Laden</button>
        
        <div id="vocab-selection" class="hidden">
            <h2>Vokabeln auswählen</h2>
            <div id="vocab-list"></div>
            <button id="start-training">Training starten</button>
        </div>
    </div>

    <div id="training" class="hidden">
        <h2>Vokabeltraining</h2>
        <p id="question"></p>
        <input type="text" id="answer" placeholder="Antwort eingeben">
        <button id="submit-answer">Antwort prüfen</button>
        <p id="result"></p>
        <button id="next-word">Nächste Frage</button>
        <button id="restart">Nochmal</button>
        <button id="back-to-menu">Menü</button>
    </div>

    <script>
        let words = [], selectedWords = [], currentWordIndex = 0;
        const csvUrls = {
            'LW1': 'LW1.csv',
            'Caesars_Bellum_Gallicum_III': 'Caesars_Bellum_Gallicum_III.csv',
            'LW2': 'LW2.csv'
        };

        document.getElementById('load-file').addEventListener('click', () => {
            fetch(csvUrls[document.getElementById('csv-select').value])
                .then(response => response.text())
                .then(data => {
                    words = data.split('\n').map(row => {
                        const cols = row.split(',');
                        return { latin: cols[0], german: cols[2] };
                    }).filter(word => word.latin && word.german);
                    showVocabSelection();
                });
        });

        function showVocabSelection() {
            const list = document.getElementById('vocab-list');
            list.innerHTML = words.map((word, i) => `
                <label><input type="checkbox" value="${i}"> ${word.latin} - ${word.german}</label>
            `).join('');
            document.getElementById('vocab-selection').classList.remove('hidden');
        }

        document.getElementById('start-training').addEventListener('click', () => {
            selectedWords = Array.from(document.querySelectorAll('#vocab-list input:checked'))
                .map(cb => words[cb.value]);
            if (selectedWords.length === 0) return alert('Bitte wählen Sie Vokabeln aus!');
            document.getElementById('menu').classList.add('hidden');
            document.getElementById('training').classList.remove('hidden');
            startTraining();
        });

        function startTraining() {
            currentWordIndex = 0;
            askNextQuestion();
        }

        function askNextQuestion() {
            if (currentWordIndex >= selectedWords.length) {
                document.getElementById('question').textContent = 'Training beendet!';
                return;
            }
            document.getElementById('question').textContent = `Übersetze: ${selectedWords[currentWordIndex].latin}`;
            document.getElementById('answer').value = '';
            document.getElementById('result').textContent = '';
        }

        document.getElementById('submit-answer').addEventListener('click', () => {
            const answer = document.getElementById('answer').value.trim();
            const correct = selectedWords[currentWordIndex].german.trim();
            document.getElementById('result').textContent = answer.toLowerCase() === correct.toLowerCase()
                ? 'Richtig!' : `Falsch! Korrekt: ${correct}`;
        });

        document.getElementById('next-word').addEventListener('click', () => {
            currentWordIndex++;
            askNextQuestion();
        });

        document.getElementById('restart').addEventListener('click', startTraining);
        document.getElementById('back-to-menu').addEventListener('click', () => {
            document.getElementById('training').classList.add('hidden');
            document.getElementById('menu').classList.remove('hidden');
        });
    </script>
</body>
</html>
